# Sales Order Functions Report

**Generated:** Analysis of combined client scripts

**Total Lines:** 5086
**Total Files Combined:** 35
**Total Event Handlers:** 96
**Total Standalone Functions:** 57

---

## Execution Sequence by Event Type

### Sales Order

#### Standard Execution Order

**before_load** - 2 handler(s):

- Line 1164 (from `discount.js`)
- Line 1269 (from `discount.js`)

**onload** - 4 handler(s):

- Line 522 (from `discount.js`)
- Line 1170 (from `discount.js`)
- Line 1277 (from `discount.js`)
- Line 4995 (from `total_deduction.js`)

**refresh** - 7 handler(s):

- Line 527 (from `discount.js`)
- Line 1193 (from `discount.js`)
- Line 1300 (from `discount.js`)
- Line 2928 (from `order_type.js`)
- Line 2948 (from `outstanding.js`)
- Line 4231 (from `sms2.js`)
- Line 4998 (from `total_deduction.js`)

**validate** - 6 handler(s):

- Line 5 (from `add_row.js`)
- Line 39 (from `approval_amount_limit.js`)
- Line 3582 (from `sales_order_3.js`)
- Line 3828 (from `sales_order_script.js`)
- Line 4904 (from `tolal_items_discount.js`)
- Line 5057 (from `total_price_list_rate.js`)

**before_save** - 1 handler(s):

- Line 3895 (from `sales_order_script.js`)

**after_save** - 1 handler(s):

- Line 540 (from `discount.js`)

**before_submit** - 1 handler(s):

- Line 4077 (from `sales_order2.js`)

**on_submit** - 3 handler(s):

- Line 3395 (from `request_for_quotation.js`)
- Line 3603 (from `sales_order_3.js`)
- Line 3737 (from `sales_order_insurance_data.js`)

**customer** - 1 handler(s):

- Line 3689 (from `sales_order_insurance_data.js`)

**order_type** - 1 handler(s):

- Line 2936 (from `order_type.js`)

**grand_total** - 1 handler(s):

- Line 2954 (from `outstanding.js`)

**advance_paid** - 1 handler(s):

- Line 2960 (from `outstanding.js`)

**custom_insurance_company** - 1 handler(s):

- Line 393 (from `contract_discount.js`)

**custom_contract_discount** - 1 handler(s):

- Line 416 (from `contract_discount.js`)

**custom_approval_amount** - 1 handler(s):

- Line 3885 (from `sales_order_script.js`)

**custom_insurance_percentage** - 1 handler(s):

- Line 3865 (from `sales_order_script.js`)

**custom_maximum_limit** - 1 handler(s):

- Line 3875 (from `sales_order_script.js`)

**custom_discount_amount_emp** - 1 handler(s):

- Line 1320 (from `discount.js`)

**custom_date** - 1 handler(s):

- Line 4171 (from `search_in_old_eye_examination.js`)

**custom_items_available** - 1 handler(s):

- Line 99 (from `available_percentage.js`)

#### Other Events

**after_item_remove** - 1 handler(s):

- Line 1361 (from `discount.js`)

**callback** - 18 handler(s):

- Line 183 (from `available_percentage.js`)
- Line 277 (from `available_percentage.js`)
- Line 3249 (from `payment_entry_sales_order.js`)
- Line 3448 (from `request_for_quotation.js`)
- Line 3482 (from `request_for_quotation.js`)
- Line 3612 (from `sales_order_3.js`)
- Line 3658 (from `sales_order_3.js`)
- Line 3663 (from `sales_order_3.js`)
- Line 3697 (from `sales_order_insurance_data.js`)
- Line 3751 (from `sales_order_insurance_data.js`)
- Line 3814 (from `sales_order_insurance_data.js`)
- Line 4304 (from `sms2.js`)
- Line 4599 (from `stock_table_so.js`)
- Line 4666 (from `stock_table_so.js`)
- Line 4691 (from `stock_table_so.js`)
- Line 4804 (from `stock_table_so.js`)
- Line 4832 (from `stock_table_so.js`)
- Line 4837 (from `stock_table_so.js`)

**custom__insurance_data_add** - 1 handler(s):

- Line 16 (from `add_row.js`)

**custom_size_add** - 1 handler(s):

- Line 25 (from `add_row.js`)

**error** - 3 handler(s):

- Line 3487 (from `request_for_quotation.js`)
- Line 3507 (from `request_for_quotation.js`)
- Line 4309 (from `sms2.js`)

**items_on_change** - 1 handler(s):

- Line 537 (from `discount.js`)

**items_on_form_render** - 1 handler(s):

- Line 534 (from `discount.js`)

**primary_action** - 3 handler(s):

- Line 628 (from `discount.js`)
- Line 1992 (from `insurance_data.js`)
- Line 3192 (from `payment_entry_sales_order.js`)

**secondary_action** - 1 handler(s):

- Line 642 (from `discount.js`)

**set_warehouse** - 1 handler(s):

- Line 506 (from `delete_row.js`)

---

### Sales Order Item

#### Standard Execution Order

**item_code** - 4 handler(s):

- Line 1368 (from `discount.js`)
- Line 3528 (from `reservation.js`)
- Line 3546 (from `reserved_qty.js`)
- Line 4884 (from `stock_table_so.js`)

**warehouse** - 2 handler(s):

- Line 3364 (from `projected_qty2.js`)
- Line 4887 (from `stock_table_so.js`)

**qty** - 4 handler(s):

- Line 4893 (from `stock_table_so.js`)
- Line 4923 (from `tolal_items_discount.js`)
- Line 4989 (from `total_deduction.js`)
- Line 5071 (from `total_price_list_rate.js`)

**price_list_rate** - 2 handler(s):

- Line 4920 (from `tolal_items_discount.js`)
- Line 5068 (from `total_price_list_rate.js`)

**discount_amount** - 1 handler(s):

- Line 4986 (from `total_deduction.js`)

**custom_discount** - 3 handler(s):

- Line 1218 (from `discount.js`)
- Line 1382 (from `discount.js`)
- Line 4911 (from `tolal_items_discount.js`)

**custom_discount2** - 1 handler(s):

- Line 4917 (from `tolal_items_discount.js`)

**custom_discount_percentage** - 1 handler(s):

- Line 4914 (from `tolal_items_discount.js`)

**items_add** - 2 handler(s):

- Line 490 (from `delete_row.js`)
- Line 1262 (from `discount.js`)

**items_remove** - 1 handler(s):

- Line 1389 (from `discount.js`)

**before_items_remove** - 1 handler(s):

- Line 461 (from `delete_row.js`)

**projected_qty** - 1 handler(s):

- Line 4890 (from `stock_table_so.js`)

#### Other Events

**callback** - 2 handler(s):

- Line 3378 (from `projected_qty2.js`)
- Line 3559 (from `reserved_qty.js`)

---

### Sales Invoice

#### Other Events

**callback** - 1 handler(s):

- Line 3085 (from `payment_entry_sales_invoice.js`)

**primary_action** - 1 handler(s):

- Line 3027 (from `payment_entry_sales_invoice.js`)

---

### Sales Order Payment

#### Other Events

**mode_of_payment** - 1 handler(s):

- Line 2649 (from `mode_of_payment_account.js`)

---

## Event Handlers Summary by Type

### Sales Order

| Event | Count |
|-------|-------|
| `advance_paid` | 1 |
| `after_item_remove` | 1 |
| `after_save` | 1 |
| `before_load` | 2 |
| `before_save` | 1 |
| `before_submit` | 1 |
| `callback` | 18 |
| `custom__insurance_data_add` | 1 |
| `custom_approval_amount` | 1 |
| `custom_contract_discount` | 1 |
| `custom_date` | 1 |
| `custom_discount_amount_emp` | 1 |
| `custom_insurance_company` | 1 |
| `custom_insurance_percentage` | 1 |
| `custom_items_available` | 1 |
| `custom_maximum_limit` | 1 |
| `custom_size_add` | 1 |
| `customer` | 1 |
| `error` | 3 |
| `grand_total` | 1 |
| `items_on_change` | 1 |
| `items_on_form_render` | 1 |
| `on_submit` | 3 |
| `onload` | 4 |
| `order_type` | 1 |
| `primary_action` | 3 |
| `refresh` | 7 |
| `secondary_action` | 1 |
| `set_warehouse` | 1 |
| `validate` | 6 |

### Sales Order Item

| Event | Count |
|-------|-------|
| `before_items_remove` | 1 |
| `callback` | 2 |
| `custom_discount` | 3 |
| `custom_discount2` | 1 |
| `custom_discount_percentage` | 1 |
| `discount_amount` | 1 |
| `item_code` | 4 |
| `items_add` | 2 |
| `items_remove` | 1 |
| `price_list_rate` | 2 |
| `projected_qty` | 1 |
| `qty` | 4 |
| `warehouse` | 2 |

### Sales Invoice

| Event | Count |
|-------|-------|
| `callback` | 1 |
| `primary_action` | 1 |

### Sales Order Payment

| Event | Count |
|-------|-------|
| `mode_of_payment` | 1 |

## Standalone Functions

**Total:** 57

| Function Name | Line |
|---------------|------|
| `start_availability_poll()` | 135 |
| `stop_availability_poll()` | 148 |
| `compute_and_apply_availability()` | 156 |
| `apply_percentage_ui_and_field()` | 222 |
| `fallback_db_update()` | 267 |
| `update_available_qty_strict()` | 355 |
| `calculate_deductible_amount()` | 442 |
| `update_discount_button()` | 549 |
| `count_pending_discounts()` | 577 |
| `show_individual_discount_dialogs()` | 586 |
| `show_next_dialog()` | 599 |
| `get_local_key()` | 656 |
| `generateRandomCode()` | 763 |
| `update_discount()` | 779 |
| `sync_main_discount()` | 871 |
| `validate_discount_field()` | 908 |
| `get_item_max_discount()` | 942 |
| `get_allowed_discount_limit()` | 948 |
| `check_main_discount()` | 964 |
| `distribute_discount()` | 1399 |
| `apply_discount_to_row()` | 1424 |
| `validate_row_discount()` | 1441 |
| `validate_total_discount()` | 1458 |
| `rollback_discount()` | 1477 |
| `showEmployeeError()` | 1487 |
| `showLimitError()` | 1495 |
| `showTotalError()` | 1503 |
| `open_insurance_dialog()` | 1819 |
| `_open_insurance_dialog_logic()` | 1827 |
| `render_order_insurance_table()` | 2101 |
| `apply_insurance_to_dialog()` | 2166 |
| `extract_insurance_from_row()` | 2194 |
| `is_same_insurance_item()` | 2223 |
| `is_same_insurance_row()` | 2252 |
| `load_insurance_from_order()` | 2284 |
| `set_insurance_on_order()` | 2312 |
| `save_new_insurance()` | 2349 |
| `finish_save()` | 2443 |
| `link_insurance_to_sales_order()` | 2453 |
| `load_previous_insurance()` | 2529 |
| `open_multi_add_dialog_for_native_table()` | 2718 |
| `search_items_with_stock_for_native()` | 2858 |
| `open_quick_payment_dialog_for_so()` | 2989 |
| `open_quick_payment_dialog_for_so()` | 3154 |
| `recalculate_insurance_amounts_v1()` | 3930 |
| `recalculate_insurance_amounts_v2()` | 4003 |
| `init_strict_colors()` | 4537 |
| `apply_strict_colors()` | 4565 |
| `color_single_row()` | 4581 |
| `inject_strict_css()` | 4633 |
| `open_stock_dialog()` | 4651 |
| `create_stock_entry()` | 4783 |
| `update_discount()` | 4929 |
| `update_all_discounts()` | 4959 |
| `update_total_deduction()` | 5007 |
| `calculate_total_insurance()` | 5047 |
| `recalc_row_and_total()` | 5076 |

## Source Files

| # | File Name | Line |
|---|-----------|------|
| 1 | `add_row.js` | 2 |
| 2 | `approval_amount_limit.js` | 36 |
| 3 | `available_percentage.js` | 55 |
| 4 | `available_qty.js` | 287 |
| 5 | `contract_discount.js` | 390 |
| 6 | `deductible_amount.js` | 425 |
| 7 | `delete_row.js` | 458 |
| 8 | `discount.js` | 519 |
| 9 | `from_so_table_to_inv_table.js` | 1512 |
| 10 | `from_so_to_inv.js` | 1717 |
| 11 | `insurance_data.js` | 1741 |
| 12 | `items_available.js` | 2620 |
| 13 | `mode_of_payment_account.js` | 2634 |
| 14 | `multi_add_button.js` | 2684 |
| 15 | `order_type.js` | 2925 |
| 16 | `outstanding.js` | 2945 |
| 17 | `payment_entry_sales_invoice.js` | 2969 |
| 18 | `payment_entry_sales_order.js` | 3134 |
| 19 | `payment_schedule.js` | 3303 |
| 20 | `projected_qty2.js` | 3361 |
| 21 | `request_for_quotation.js` | 3392 |
| 22 | `reservation.js` | 3525 |
| 23 | `reserved_qty.js` | 3543 |
| 24 | `sales_order_3.js` | 3579 |
| 25 | `sales_order_insurance_data.js` | 3686 |
| 26 | `sales_order_script.js` | 3825 |
| 27 | `sales_order2.js` | 4074 |
| 28 | `search_in_old_eye_examination.js` | 4168 |
| 29 | `sms2.js` | 4228 |
| 30 | `stock_entry.js` | 4325 |
| 31 | `stock_table_so.js` | 4506 |
| 32 | `tolal_items_discount.js` | 4899 |
| 33 | `total_deduction.js` | 4981 |
| 34 | `total_insurance.js` | 5030 |
| 35 | `total_price_list_rate.js` | 5054 |

